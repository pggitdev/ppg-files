<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô - ‡∏®‡∏∏‡∏†‡∏≤‡∏•‡∏±‡∏¢ ‡∏û‡∏£‡∏µ‡∏°‡πà‡∏≤ ‡∏ß‡∏¥‡∏•‡∏•‡πà‡∏≤</title>
    
    <!-- Google Fonts: Sarabun for Thai support -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body {
            font-family: 'Sarabun', sans-serif;
        }
        .fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Highlight animation for targeted note */
        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.7); border-color: #F59E0B; }
            70% { box-shadow: 0 0 0 10px rgba(245, 158, 11, 0); border-color: #F59E0B; }
            100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0); border-color: #e5e7eb; }
        }
        .target-highlight {
            animation: highlightPulse 2s ease-out;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-4 md:p-8">

    <div class="max-w-4xl mx-auto bg-white rounded-2xl shadow-xl overflow-hidden flex flex-col min-h-[800px]">
        
        <!-- Header Section -->
        <div class="bg-slate-800 text-white p-6 md:p-8 relative overflow-hidden flex-shrink-0">
            <div class="absolute top-0 right-0 p-4 opacity-10">
                <i data-lucide="building-2" width="120" height="120"></i>
            </div>
            <div class="relative z-10">
                <div class="flex items-center gap-3 mb-2">
                    <div class="w-2 h-8 bg-amber-500 rounded-full"></div>
                    <h2 class="text-sm md:text-base text-amber-400 font-semibold tracking-wide uppercase">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</h2>
                </div>
                <h1 class="text-xl md:text-2xl font-bold leading-tight mb-2" id="orgName"></h1>
                <p class="text-sm text-gray-400 mt-1" id="date"></p>
            </div>
        </div>

        <!-- Tabs Navigation -->
        <div class="flex border-b border-gray-200 bg-white sticky top-0 z-20 shadow-sm">
            <button onclick="switchTab('balance')" id="tab-balance" class="flex-1 flex items-center justify-center gap-2 py-4 px-2 text-sm md:text-base font-medium transition-all border-b-4 border-amber-500 text-amber-600 bg-amber-50">
                <i data-lucide="wallet" width="18"></i>
                <span>‡∏á‡∏ö‡∏î‡∏∏‡∏•</span>
            </button>
            <button onclick="switchTab('income')" id="tab-income" class="flex-1 flex items-center justify-center gap-2 py-4 px-2 text-sm md:text-base font-medium transition-all border-b-4 border-transparent text-gray-500 hover:text-gray-700 hover:bg-gray-50">
                <i data-lucide="activity" width="18"></i>
                <span>‡∏á‡∏ö‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö-‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</span>
            </button>
            <button onclick="switchTab('notes')" id="tab-notes" class="flex-1 flex items-center justify-center gap-2 py-4 px-2 text-sm md:text-base font-medium transition-all border-b-4 border-transparent text-gray-500 hover:text-gray-700 hover:bg-gray-50">
                <i data-lucide="file-text" width="18"></i>
                <span>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</span>
            </button>
        </div>

        <!-- Content Area -->
        <div class="flex-grow bg-white relative">
            
            <!-- Currency Badge -->
            <div class="bg-gray-50 border-b border-gray-200 px-6 py-2 flex justify-end">
                <span class="text-xs font-semibold text-gray-500 bg-gray-200 px-2 py-1 rounded" id="unit"></span>
            </div>

            <!-- Tab Content Containers -->
            <div id="content-balance" class="fade-in"></div>
            <div id="content-income" class="hidden fade-in"></div>
            <div id="content-notes" class="hidden fade-in"></div>
            
        </div>

    </div>

    <!-- JavaScript Logic -->
    <script>
        // --- DATA (Same as React Component) ---
        const headerData = {
            orgName: "‡∏ô‡∏¥‡∏ï‡∏¥‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô‡∏à‡∏±‡∏î‡∏™‡∏£‡∏£ ‡∏®‡∏∏‡∏†‡∏≤‡∏•‡∏±‡∏¢ ‡∏û‡∏£‡∏µ‡∏°‡πà‡∏≤ ‡∏ß‡∏¥‡∏•‡∏•‡πà‡∏≤ ‡πÄ‡∏û‡∏ä‡∏£‡πÄ‡∏Å‡∏©‡∏°-‡∏û‡∏∏‡∏ó‡∏ò‡∏°‡∏ì‡∏ë‡∏•‡∏™‡∏≤‡∏¢ 1",
            date: "‡∏ì ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 31 ‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏° 2567",
            unit: "‡∏´‡∏ô‡πà‡∏ß‡∏¢ : ‡∏ö‡∏≤‡∏ó"
        };

        const balanceSheetData = {
            assets: {
                title: "‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå",
                items: [
                    { name: "‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô", isHeader: true },
                    { name: "‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î", note: "4", year2567: "1,115,435.31", year2566: "1,091,121.30" },
                    { name: "‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å", note: "5", year2567: "-", year2566: "16,117.00" },
                    { name: "‡∏£‡∏ß‡∏°‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô", isTotal: true, year2567: "1,115,435.31", year2566: "1,107,238.30" },
                    { name: "‡∏£‡∏ß‡∏°‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå", isGrandTotal: true, year2567: "1,115,435.31", year2566: "1,107,238.30" },
                ]
            },
            liabilities: {
                title: "‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å",
                items: [
                    { name: "‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô", isHeader: true },
                    { name: "‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ñ‡πâ‡∏≤‡∏á‡∏à‡πà‡∏≤‡∏¢", note: "", year2567: "85,554.56", year2566: "83,200.00" },
                    { name: "‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πâ‡∏≤‡∏á‡∏à‡πà‡∏≤‡∏¢", note: "6", year2567: "21,163.70", year2566: "18,919.30" },
                    { name: "‡∏£‡∏ß‡∏°‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô", isTotal: true, year2567: "106,718.26", year2566: "102,119.30" },
                    { name: "‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô", isHeader: true },
                    { name: "‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏ï‡∏¥‡∏°", note: "", year2567: "-", year2566: "20,000.00" },
                    { name: "‡∏£‡∏ß‡∏°‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô", isTotal: true, year2567: "-", year2566: "20,000.00" },
                    { name: "‡∏£‡∏ß‡∏°‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô", isGrandTotal: true, year2567: "106,718.26", year2566: "122,119.30" },
                ]
            },
            equity: {
                title: "‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å",
                items: [
                    { name: "‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏π‡∏õ‡πÇ‡∏†‡∏Ñ", note: "", year2567: "682,391.00", year2566: "682,391.00" },
                    { name: "‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤(‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤)‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏∞‡∏™‡∏°", note: "", year2567: "326,326.05", year2566: "302,728.00" },
                    { name: "‡∏£‡∏ß‡∏°‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å", isTotal: true, year2567: "1,008,717.05", year2566: "985,119.00" },
                    { name: "‡∏£‡∏ß‡∏°‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å", isGrandTotal: true, year2567: "1,115,435.31", year2566: "1,107,238.30" },
                ]
            }
        };

        const incomeStatementData = {
            revenue: {
                title: "‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö (Revenues)",
                items: [
                    { name: "‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö - ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞", note: "", year2567: "1,746,855.60", year2566: "1,746,855.60" },
                    { name: "‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö - ‡∏Ñ‡∏µ‡∏¢‡πå‡∏Å‡∏≤‡∏£‡πå‡∏î", note: "", year2567: "-", year2566: "4,000.00" },
                    { name: "‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö - ‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢", note: "", year2567: "100,000.00", year2566: "-" },
                    { name: "‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏±‡∏ö", note: "", year2567: "9,859.45", year2566: "2,305.40" },
                    { name: "‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏≠‡∏∑‡πà‡∏ô", note: "", year2567: "840.72", year2566: "200,000.00" },
                    { name: "‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö", isGrandTotal: true, year2567: "1,857,555.77", year2566: "1,953,161.00", color: "emerald" },
                ]
            },
            expense: {
                title: "‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ (Expenses)",
                items: [
                    { name: "‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£", note: "7", year2567: "1,550,300.46", year2566: "1,528,320.00" },
                    { name: "‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏π‡∏õ‡πÇ‡∏†‡∏Ñ", note: "8", year2567: "96,009.43", year2566: "98,761.58" },
                    { name: "‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô", note: "9", year2567: "17,100.00", year2566: "27,045.53" },
                    { name: "‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°‡πÅ‡∏•‡∏∞‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤", note: "10", year2567: "170,547.83", year2566: "7,545.00" },
                    { name: "‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢", isGrandTotal: true, year2567: "1,833,957.72", year2566: "1,661,672.11", color: "rose" },
                ]
            },
            net: {
                items: [
                    { name: "‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤(‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤)‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏∏‡∏ó‡∏ò‡∏¥", isGrandTotal: true, year2567: "23,598.05", year2566: "291,488.89", color: "blue" }
                ]
            }
        };

        const notesData = [
            {
                id: "7",
                title: "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ 7: ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£",
                total2567: "1,550,300.46",
                items: [
                    { name: "‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£", year2567: "256,800.00", year2566: "256,800.00" },
                    { name: "‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢", year2567: "1,053,847.28", year2566: "1,027,200.00", highlight: true },
                    { name: "‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏Å‡∏ß‡∏≤‡∏î‡∏ñ‡∏ô‡∏ô", year2567: "235,333.18", year2566: "240,000.00" },
                    { name: "‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡∏¢‡∏∞", year2567: "4,320.00", year2566: "4,320.00" },
                ]
            },
            {
                id: "10",
                title: "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ 10: ‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°‡πÅ‡∏•‡∏∞‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤",
                total2567: "170,547.83",
                items: [
                    { name: "‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏•‡∏≤‡∏á", year2567: "3,422.00", year2566: "2,810.00" },
                    { name: "‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏ü‡∏ü‡πâ‡∏≤", year2567: "-", year2566: "4,735.00" },
                    { name: "‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°‡∏á‡∏≤‡∏ô‡∏™‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏†‡∏π‡∏°‡∏¥‡∏ó‡∏±‡∏®‡∏ô‡πå", year2567: "165,609.33", year2566: "-", highlight: true },
                    { name: "‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏ß‡∏á‡∏à‡∏£‡∏õ‡∏¥‡∏î", year2567: "1,016.50", year2566: "-" },
                    { name: "‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏≠‡∏Å‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô", year2567: "500.00", year2566: "-" },
                ]
            },
            {
                id: "8",
                title: "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ 8: ‡∏Ñ‡πà‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏π‡∏õ‡πÇ‡∏†‡∏Ñ",
                total2567: "96,009.43",
                items: [
                    { name: "‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏ü‡πâ‡∏≤", year2567: "66,484.91", year2566: "78,995.90" },
                    { name: "‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏õ‡∏≤", year2567: "20,549.36", year2566: "9,956.57" },
                    { name: "‡∏Ñ‡πà‡∏≤‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡πÅ‡∏•‡∏∞‡∏≠‡∏¥‡∏ô‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï", year2567: "8,975.16", year2566: "9,809.11" },
                ]
            },
            {
                id: "6",
                title: "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ 6: ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πâ‡∏≤‡∏á‡∏à‡πà‡∏≤‡∏¢ (‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô)",
                total2567: "21,163.70",
                items: [
                    { name: "‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏Ñ‡πâ‡∏≤‡∏á‡∏à‡πà‡∏≤‡∏¢", year2567: "3,702.25", year2566: "5,097.84" },
                    { name: "‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏õ‡∏≤‡∏Ñ‡πâ‡∏≤‡∏á‡∏à‡πà‡∏≤‡∏¢", year2567: "1,745.60", year2566: "493.53" },
                    { name: "‡∏Ñ‡πà‡∏≤‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏Ñ‡πâ‡∏≤‡∏á‡∏à‡πà‡∏≤‡∏¢", year2567: "747.93", year2566: "747.93" },
                    { name: "‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡∏¢‡∏∞‡∏°‡∏π‡∏•‡∏ù‡∏≠‡∏¢‡∏Ñ‡πâ‡∏≤‡∏á‡∏à‡πà‡∏≤‡∏¢", year2567: "5,400.00", year2566: "1,080.00" },
                    { name: "‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏¢‡πâ‡∏≤‡∏¢‡∏Ç‡∏¢‡∏∞‡∏°‡∏π‡∏•‡∏ù‡∏≠‡∏¢‡∏Ñ‡πâ‡∏≤‡∏á‡∏à‡πà‡∏≤‡∏¢", year2567: "500.00", year2566: "500.00" },
                    { name: "‡∏Ñ‡πà‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Ñ‡πâ‡∏≤‡∏á‡∏à‡πà‡∏≤‡∏¢", year2567: "6,000.00", year2566: "8,000.00" },
                    { name: "‡∏†‡∏≤‡∏©‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏≠‡∏ô‡∏≥‡∏™‡πà‡∏á", year2567: "3,067.92", year2566: "3,000.00" },
                ]
            }
        ];

        // --- RENDER HELPERS ---

        function renderTableRow(item, colorTheme) {
            let rowClass = "border-b border-gray-100 hover:bg-gray-50 transition-colors";
            let nameClass = "py-3 px-4 text-gray-700";
            let numClass = "py-3 px-4 text-right font-medium text-gray-700 tabular-nums";
            
            if (item.isHeader) {
                return `
                    <tr class="bg-gray-50/50">
                        <td colSpan="4" class="py-2 px-4 text-sm font-semibold ${colorTheme.text} italic">
                            ${item.name}
                        </td>
                    </tr>
                `;
            }

            if (item.isTotal) {
                rowClass = `border-t-2 border-${colorTheme.border} bg-${colorTheme.bg} bg-opacity-10`;
                nameClass = `py-3 px-4 font-bold ${colorTheme.text}`;
                numClass = `py-3 px-4 text-right font-bold ${colorTheme.text} tabular-nums`;
            }

            if (item.isGrandTotal) {
                const bgClass = item.color ? `bg-${item.color}-600` : `bg-${colorTheme.bg}`;
                rowClass = `${bgClass} text-white shadow-sm`;
                nameClass = "py-4 px-4 font-bold text-white";
                numClass = "py-4 px-4 text-right font-bold text-white tabular-nums text-lg";
            }

            const highlightBadge = item.highlight ? `<span class="ml-2 inline-block px-2 py-0.5 text-xs bg-yellow-100 text-yellow-800 rounded-full">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</span>` : '';
            const year2566Class = item.isGrandTotal ? 'text-white' : 'text-gray-500';

            // Logic to make note clickable
            let noteContent = item.note || '';
            if (item.note) {
                 noteContent = `
                    <button onclick="goToNote('${item.note}')" class="group relative inline-flex items-center justify-center">
                        <span class="underline text-amber-600 font-bold hover:text-amber-800 transition-colors">${item.note}</span>
                        <span class="absolute -top-8 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none">
                            ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
                        </span>
                    </button>
                 `;
            }

            return `
                <tr class="${rowClass}">
                    <td class="${nameClass}">
                        ${item.name} ${highlightBadge}
                    </td>
                    <td class="py-3 px-2 text-center text-gray-400 text-xs">${noteContent}</td>
                    <td class="${numClass}">${item.year2567}</td>
                    <td class="${numClass} ${year2566Class}">${item.year2566}</td>
                </tr>
            `;
        }

        function createTableSection(title, iconName, items, theme) {
            return `
                <div class="flex items-center gap-2 mb-4 ${theme.text}">
                    <i data-lucide="${iconName}" width="24" height="24"></i>
                    <h2 class="text-xl font-bold">${title}</h2>
                </div>
                <div class="overflow-x-auto rounded-lg border border-gray-200 mb-8">
                    <table class="w-full text-sm md:text-base">
                        <thead>
                            <tr class="bg-${theme.bgBase}-50 text-${theme.textBase}-800 border-b border-${theme.bgBase}-100">
                                <th class="py-3 px-4 text-left w-5/12">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                                <th class="py-3 px-2 text-center w-1/12">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                                <th class="py-3 px-4 text-right w-3/12">‡∏õ‡∏µ 2567</th>
                                <th class="py-3 px-4 text-right w-3/12">‡∏õ‡∏µ 2566</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${items.map(item => renderTableRow(item, theme)).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }

        // --- RENDER FUNCTIONS FOR TABS ---

        function renderBalanceSheet() {
            const container = document.getElementById('content-balance');
            container.innerHTML = `
                <div class="p-6">
                    ${createTableSection(balanceSheetData.assets.title, 'wallet', balanceSheetData.assets.items, { 
                        text: 'text-emerald-700', bg: 'emerald-600', border: 'emerald-200', bgBase: 'emerald', textBase: 'emerald' 
                    })}
                    ${createTableSection(balanceSheetData.liabilities.title, 'credit-card', balanceSheetData.liabilities.items, { 
                        text: 'text-rose-700', bg: 'rose-600', border: 'rose-200', bgBase: 'rose', textBase: 'rose'
                    })}
                    ${createTableSection(balanceSheetData.equity.title, 'pie-chart', balanceSheetData.equity.items, { 
                        text: 'text-blue-700', bg: 'slate-800', border: 'blue-200', bgBase: 'blue', textBase: 'blue'
                    })}
                </div>
            `;
        }

        function renderIncomeStatement() {
            const container = document.getElementById('content-income');
            container.innerHTML = `
                <div class="p-6">
                    <div class="mb-6 p-4 bg-amber-50 border border-amber-200 rounded-lg text-amber-800 text-sm">
                        <h3 class="font-bold mb-1">üí° ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô</h3>
                        <p>‡∏õ‡∏µ 2567 ‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ <span class="font-bold text-emerald-600">23,598.05 ‡∏ö‡∏≤‡∏ó</span> (‡∏•‡∏î‡∏•‡∏á‡∏à‡∏≤‡∏Å‡∏õ‡∏µ‡∏Å‡πà‡∏≠‡∏ô)</p>
                    </div>

                    ${createTableSection(incomeStatementData.revenue.title, 'trending-up', incomeStatementData.revenue.items, { 
                        text: 'text-emerald-700', bg: 'emerald-600', border: 'emerald-200', bgBase: 'emerald', textBase: 'emerald' 
                    })}
                    ${createTableSection(incomeStatementData.expense.title, 'trending-down', incomeStatementData.expense.items, { 
                        text: 'text-rose-700', bg: 'rose-600', border: 'rose-200', bgBase: 'rose', textBase: 'rose'
                    })}
                    
                    <div class="overflow-x-auto rounded-lg border border-gray-200 shadow-sm">
                        <table class="w-full text-sm md:text-base">
                            <tbody>
                                ${incomeStatementData.net.items.map(item => renderTableRow(item, { text: 'text-blue-700', bg: 'blue-600', border: 'blue-200' })).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderNotes() {
            const container = document.getElementById('content-notes');
            // scroll-mt-24 ensures the sticky header doesn't hide the note title when scrolling
            const itemsHtml = notesData.map(note => `
                <div id="note-${note.id}" class="scroll-mt-24 bg-white rounded-lg border border-gray-200 overflow-hidden shadow-sm hover:shadow-md transition-all duration-300">
                    <div class="bg-gray-50 px-4 py-3 border-b border-gray-200 flex justify-between items-center">
                        <h3 class="font-bold text-gray-800 flex items-center gap-2">
                            <i data-lucide="chevron-right" class="text-amber-500" width="16"></i>
                            ${note.title}
                        </h3>
                        <span class="text-sm font-semibold text-gray-600 bg-white px-2 py-1 rounded border border-gray-200">
                            ‡∏£‡∏ß‡∏°: ${note.total2567}
                        </span>
                    </div>
                    <table class="w-full text-sm">
                        <thead>
                                <tr class="bg-gray-50/50 text-gray-500 text-xs uppercase tracking-wider">
                                <th class="py-2 px-4 text-left">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                                <th class="py-2 px-4 text-right">‡∏õ‡∏µ 2567</th>
                                <th class="py-2 px-4 text-right hidden md:table-cell">‡∏õ‡∏µ 2566</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-100">
                            ${note.items.map(subItem => `
                                <tr class="hover:bg-gray-50">
                                    <td class="py-2 px-4 text-gray-700">
                                        ${subItem.name}
                                        ${subItem.highlight ? '<span class="ml-2 text-[10px] bg-red-100 text-red-600 px-1.5 py-0.5 rounded">‡∏™‡∏π‡∏á</span>' : ''}
                                    </td>
                                    <td class="py-2 px-4 text-right font-medium text-gray-900">${subItem.year2567}</td>
                                    <td class="py-2 px-4 text-right text-gray-400 hidden md:table-cell">${subItem.year2566}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `).join('');

            container.innerHTML = `<div class="p-6 grid gap-8">${itemsHtml}</div>`;
        }

        // --- TAB & NAVIGATION LOGIC ---

        function switchTab(tabId) {
            // Hide all contents
            document.getElementById('content-balance').classList.add('hidden');
            document.getElementById('content-income').classList.add('hidden');
            document.getElementById('content-notes').classList.add('hidden');

            // Show selected content
            document.getElementById(`content-${tabId}`).classList.remove('hidden');

            // Reset tab styles
            const tabs = ['balance', 'income', 'notes'];
            tabs.forEach(t => {
                const btn = document.getElementById(`tab-${t}`);
                btn.className = "flex-1 flex items-center justify-center gap-2 py-4 px-2 text-sm md:text-base font-medium transition-all border-b-4 border-transparent text-gray-500 hover:text-gray-700 hover:bg-gray-50";
            });

            // Set active tab style
            const activeBtn = document.getElementById(`tab-${tabId}`);
            activeBtn.className = "flex-1 flex items-center justify-center gap-2 py-4 px-2 text-sm md:text-base font-medium transition-all border-b-4 border-amber-500 text-amber-600 bg-amber-50";
        }

        function goToNote(noteId) {
            // 1. Switch to notes tab
            switchTab('notes');
            
            // 2. Wait for rendering to settle then find and scroll
            setTimeout(() => {
                const element = document.getElementById(`note-${noteId}`);
                if (element) {
                    element.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    
                    // 3. Add temporary highlight class
                    element.classList.remove('target-highlight'); // reset if already there
                    void element.offsetWidth; // trigger reflow
                    element.classList.add('target-highlight');
                }
            }, 50);
        }

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            // Set Header Info
            document.getElementById('orgName').textContent = headerData.orgName;
            document.getElementById('date').textContent = headerData.date;
            document.getElementById('unit').textContent = headerData.unit;

            // Render all sections once
            renderBalanceSheet();
            renderIncomeStatement();
            renderNotes();

            // Initialize Icons
            lucide.createIcons();
        });

    </script>
</body>
</html>
